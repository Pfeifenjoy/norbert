%!TEX root = ../documentation.tex


\chapter{Anbindung externer Dienste - Dropbox}

Eines der Ziele von Norbert - Your StudyBuddy ist es Wissensmanagement zu betreiben und somit Wissen zu sammeln und weiterzugeben. Da Informationen und Wissen von Studierenden einer DHBW meistens in Dropbox abgelegt werden, wird in diesem Kapitel die Anbindung von Dropbox an Norbert beschrieben. Dabei wird zunächst erst allgemein auf den standardisierten Autorisiuerngsprozess \enquote{OAuth} eingegangen und daraufhin die verschiedenen Dropbox Endpoints mit ihren Schnittstellen vorgestellt.


\section{Autorisierungsprozess (OAuth)}

OAuth ist ein offenes Protokoll, dass eine standardisierte und sichere API-Autorisierung für mobile Endgeräte, Webanwendungen und Desktop-Applikationen ermöglicht. Der Benutzer kann über den OAuth-Autorisierungsprozess (Abbildung \ref{04ergebnis:oauth}) einer Anwendung (in diesem Fall Norbert) Zugriff auf gespeicherte Daten erlauben. Dabei loggt sich der Benutzer über die Applikation (Norbert) die Zugriff benötigt auf dem Dienst, der die freizugebenden Daten speichert, ein (hier Dropbox) und erlaubt somit der Applikation den Zugriff. Dabei wird ein spezieller App key mit entsprechendem App scecret und ein Access-Token zwischen der Applikation und dem Dienst ausgetauscht. Der Access-Token wird individuelle für jeden Benutzer erstellt und wird bei API-Aufrufen mitgesendet. Dieser dient somit zur Authentifizierung des Benutzers, sodass kein Benutzername oder Passwörter ausgetauscht oder gespeichert werden müssen.

\begin{figure}[H]
\centering
	\scalebox{0.5}{\input{uml-diagramms/oauth}}
	\caption{OAuth-Autorisierungsprozess zwischen Norbert und Dropbox.com}
	\label{04ergebnis:oauth}	
\end{figure}


\section{Dropbox Endpoints}

Die Dropbox API besteht aus mehreren Endpoints (Abbildung \ref{04ergebnis:dpendpoints}), die jeweils unterschiedliche Funktionene bereitstellen. Alle API-Aufrufe benötigen zu Autorisierung den individuellen Access-Token eines Benutzers.

\begin{enumerate}
	\item \textit{dropbox.com:} Über diesen Endpoint/Webseite wird die OAuth-Autorisierung durchgeführt. Es wird nur einmalig zur Generierung des Access-Tokens ein Kontakt zu diesem Endpoint hergestellt.
	
	\item \textit{api.dropboxapi.com (RPC-Endpoint):}  Über die Domain api.dropboxapi.com können RPCs (remote procedure calls) ausgeführt werden. Dabei nimmt dieser Endpoint JSON-Strings im HTTP-Body entgegen und führt je nach aufgerufener URL verschiedene Funktionen aus. Ein RPC-Funktion ist beispielsweise list\_{folder} (\textit{https://api.dropboxapi.com/2/files/list\_{folder}}), die als Parameter einen Pfad erwartet und dann alle im entsprechenden Ordner sich
 befindenden Dateien auflistet. Das Ergebnis der Funktion wird daraufhin wieder im JSON-Format zurückgesendet.
 
 	\item \textit{content.dropboxapi.com (Download/Upload-Endpoint):} Wie der Name schon sagt, können über den Download/Upload-Endpoint Dateien heruntergeladen werden oder hochgeladen werden. Die benötigten Meta-Daten (Pfad, Datei ID etc.) werden dabei im HTTP-Header als JSON oder URL-Argument übergeben. Funktionsergebnisse werden im JSON-Format im HTTP-Response Header übergeben und Dateien im HTTP-Body übersendet.
\end{enumerate}

\begin{figure}[H]
\centering
	\scalebox{0.5}{\input{uml-diagramms/dropboxendpoints}}
	\caption{API-Zugriffe über die Dropbox-Endpoints}
	\label{04ergebnis:dpendpoints}	
\end{figure}

\section{Webhooks \& Benachrichtigungen}